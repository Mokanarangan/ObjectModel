!function(a){function b(a){return"function"==typeof a}function c(a){return"object"==typeof a}function d(a,e){if(e&&(e.length>15||e.indexOf(a)>=0))return"...";if(null==a)return String(a);if("string"==typeof a)return'"'+a+'"';if(e=[a].concat(e),b(a))return a.name||a.toString(e);if(v(a))return"["+a.map(function(a){return d(a,e)}).join(", ")+"]";if(a&&c(a)){var f=new Array(e.length).join("	");return"{"+Object.keys(a).map(function(b){return"\n	"+f+b+": "+d(a[b],e)}).join(",")+"\n"+f+"}"}return String(a)}function e(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1]}function f(a){return Array.prototype.slice.call(a)}function g(a,b,c){if(b instanceof Object)for(var d in b)b.hasOwnProperty(d)&&(a.hasOwnProperty(d)?a[d]instanceof Object?g(a[d],b[d],c):c&&(a[d]=b[d]):a[d]=b[d]);return a}function h(a,b){w||Object.defineProperty(a,"__proto__",{enumerable:!1,writable:!0,value:b})}function i(a,b){a.prototype=b,a.prototype.constructor=a}function j(a,b){Object.setPrototypeOf(a,b.prototype),Object.defineProperty(a,"constructor",{enumerable:!1,writable:!0,value:b})}function k(a){if(!l(a))return k.Object(a);var b=function(a){return b.validate(a,[]),a};return j(b,k),b.definition=a,b.assertions=[],b}function l(a){return"Object"!=e(a)}function m(a,b){return b.length?l(a)?f(b).reduce(function(a,b){return a.concat(n(b))},n(a)).filter(function(a,b,c){return c.indexOf(a)===b}):f(b).reduce(function(a,b){return g(b||{},a)},a):a}function n(a){if(l(a)){if(!v(a))return[a];if(1===a.length)return a.concat(void 0)}else Object.keys(a).forEach(function(b){a[b]=n(a[b])});return a}function o(a,b,c,f){if(l(b)){b=n(b);var g=b.length;if(!g)return;for(var h=0;g>h;h++)if(p(a,b[h],f))return;throw new TypeError("expecting "+(c?c+" to be ":"")+b.map(function(a){return d(a)}).join(" or ")+", got "+(null!=a?e(a)+" ":"")+d(a))}Object.keys(b).forEach(function(d){var e=null!=a?a[d]:void 0;o(e,b[d],c?c+"."+d:d,f.concat(e))})}function p(a,c,d){if(null==a)return a===c;if(k.instanceOf(c,k)){var e=d.indexOf(c);if(-1!==e&&-1!==d.slice(e+1).indexOf(c))return!0;try{return c.validate(a,d.concat(c)),!0}catch(f){return!1}}return c instanceof RegExp?c.test(a):a===c||b(c)&&a instanceof c||a.constructor===c}function q(a,b){for(var c=0,e=b.length;e>c;c++)if(!b[c](a))throw new TypeError("an assertion of the model is not respected: "+d(b[c]))}function r(a,b,c,d){if(k.instanceOf(c,k.Function))return c(b);if(l(c))return b;var e=b instanceof Object?b:{},f=Object.create(Object.getPrototypeOf(e));return Object.keys(c).forEach(function(g){var h=d?d+"."+g:g,i=g.toUpperCase()!=g;Object.defineProperty(f,g,{get:function(){return r(a,e[g],c[g],h)},set:function(d){if(!i&&void 0!==e[g])throw new TypeError("cannot redefine constant "+g);var f=r(a,d,c[g],h);o(f,c[g],h,[]);var j=e[g];e[g]=f;try{q(b,a.assertions)}catch(k){throw e[g]=j,k}},enumerable:"_"!==g[0]})}),f}function s(a,b,c,d){Object.defineProperty(a,c,{get:function(){return b[c]},set:function(a){u(b,c,a,d)}})}function t(a,b,c,d){return function(){var e=a.slice();if(Array.prototype[b].apply(e,arguments),c.validate(e),!x)for(var f in e)!e.hasOwnProperty(f)||f in d||s(d,a,f,c);return Array.prototype[b].apply(a,arguments)}}function u(a,b,c,d){parseInt(b)===+b&&b>=0&&o(c,d.definition,"Array["+b+"]",[]);var e=a.slice();e[b]=c,q(e,d.assertions),a[b]=c}var v=Array.isArray||function(a){return a instanceof Array},w=!!Object.setPrototypeOf||{__proto__:[]}instanceof Array;Object.setPrototypeOf=Object.setPrototypeOf||(w?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c];h(a,b)}),Object.getPrototypeOf=Object.getPrototypeOf&&w?Object.getPrototypeOf:function(a){return a.__proto__||(a.constructor?a.constructor.prototype:null)};var x="function"==typeof Proxy;i(k,Object.create(Function.prototype)),k.prototype.toString=function(a){return d(this.definition,a)},k.prototype.validate=function(a,b){o(a,this.definition,void 0,b),q(a,this.assertions)},k.prototype.extend=function(){var a=new this.constructor(m(this.definition,arguments));return i(a,Object.create(this.prototype)),h(a.prototype,this.prototype),a.assertions=f(this.assertions),a},k.prototype.assert=function(){return this.assertions=this.assertions.concat(f(arguments).filter(b)),this},k.instanceOf=function(a,b){return w?a instanceof b:function c(a,d){if(null==a||-1!==d.indexOf(a))return!1;var e=Object.getPrototypeOf(a);return d.push(a),e===b.prototype||c(e,d)}(a,[])},k.Object=function z(a){var b=function(a){if(!(this instanceof b))return new b(a);g(this,a,!0);var c=r(b,this,b.definition);return b.validate(c,[]),h(c,b.prototype),c};return j(b,z),b.definition=a,b.assertions=[],b},k.Object.prototype=Object.create(k.prototype),k.Object.prototype.constructor=k,k.Object.prototype.defaults=function(a){return g(this.prototype,a),this};var y=["pop","push","reverse","shift","sort","splice","unshift"];k.Array=function A(a){var b=function(){var a,c=f(arguments);if(b.validate(c),x)a=new Proxy(c,{get:function(a,c){return y.indexOf(c)>=0?t(a,c,b):a[c]},set:function(a,c,d){u(a,c,d,b)}});else{a=Object.create(Array.prototype);for(var d in c)c.hasOwnProperty(d)&&s(a,c,d,b);Object.defineProperty(a,"length",{get:function(){return c.length}}),y.forEach(function(d){Object.defineProperty(a,d,{configurable:!0,value:t(c,d,b,a)})})}return j(a,b),a};return i(b,Object.create(Array.prototype)),j(b,A),b.definition=a,b.assertions=[],b},k.Array.prototype=Object.create(k.prototype),k.Array.prototype.constructor=k,k.Array.prototype.validate=function(a){if(!v(a))throw new TypeError("expecting an array, got: "+d(a));for(var b=0,c=a.length;c>b;b++)o(a[b],this.definition,"Array["+b+"]",[]);q(a,this.assertions)},k.Array.prototype.toString=function(a){return"Model.Array("+d(this.definition,a)+")"},k.Function=function B(){var a=function(b){var c=a.definition,e=function(){var e=g(f(arguments),c.defaults);if(e.length!==c.arguments.length)throw new TypeError("expecting "+d(b)+" to be called with "+c.arguments.length+" arguments, got "+e.length);c.arguments.forEach(function(a,b){o(e[b],a,"arguments["+b+"]",[])}),q(e,a.assertions);var h=b.apply(this,e);return"return"in c&&o(h,c["return"],"return value",[]),h};return j(e,a),e};return i(a,Object.create(Function.prototype)),j(a,B),a.definition={arguments:f(arguments)},a.assertions=[],a},i(k.Function,Object.create(k.prototype)),k.Function.constructor.prototype=k,k.Function.prototype.validate=function(a){if(!b(a))throw new TypeError("expecting a function, got: "+d(a))},k.Function.prototype.toString=function(a){var b="Model.Function("+this.definition.arguments.map(function(b){return d(b,a)}).join(",")+")";return"return"in this.definition&&(b+=".return("+d(this.definition["return"])+")"),b},k.Function.prototype["return"]=function(a){return this.definition["return"]=a,this},k.Function.prototype.defaults=function(){return this.definition.defaults=f(arguments),this},a.Model=k}(this);