!function(a){function b(a){return"function"==typeof a}function c(a,b){if(void 0===b&&(b=1),null==a)return String(a);if("string"==typeof a)return'"'+a+'"';if("function"==typeof a)return a.name||a.toString(b);if(s(a))return"["+a.map(function(a){return c(a,b)}).join(", ")+"]";if(a&&"object"==typeof a){var d=new Array(b).join("	");return"{"+Object.keys(a).map(function(e){return"\n	"+d+e+": "+c(a[e],b+1)}).join(",")+"\n"+d+"}"}return String(a)}function d(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1]}function e(a){return Array.prototype.slice.call(a)}function f(a,b,c){return c.indexOf(a)===b}function g(a,b,c){if(b instanceof Object)for(var d in b)b.hasOwnProperty(d)&&(a.hasOwnProperty(d)?a[d]instanceof Object?g(a[d],b[d],c):c&&(a[d]=b[d]):a[d]=b[d]);return a}function h(a){if(!j(a))return new h.Object(a);var c=function(a){return c.validate(a),a};return i(c,h,Object.create(b(a)?a.prototype:null),a)}function i(a,b,c,d){return a.constructor=b,a.prototype=c,a.prototype.constructor=a,a.definition=d,a.assertions=[],Object.setPrototypeOf(a,b.prototype),a}function j(a){return"Object"!=d(a)}function k(a,b){return 0===b.length?a:j(a)?e(b).reduce(function(a,b){return a.concat(l(b))},l(a)).filter(f):e(b).reduce(function(a,b){return g(b||{},a)},a)}function l(a){if(j(a)){if(!s(a))return[a];if(1===a.length)return a.concat(void 0)}else Object.keys(a).forEach(function(b){a[b]=l(a[b])});return a}function m(a,b,c){j(b)?n(a,b,c):Object.keys(b).forEach(function(d){var e=c?[c,d].join("."):d;m(a instanceof Object?a[d]:void 0,b[d],e)})}function n(a,b,e){var f=l(b);if(f.length>0&&!f.some(function(b){return o(a,b)}))throw new TypeError("expecting "+(e?e+" to be ":"")+f.map(c).join(" or ")+", got "+(null!=a?d(a)+" ":"")+c(a))}function o(a,c){return null==a?a===c:c instanceof h?c.isValidModelFor(a):c instanceof RegExp?c.test(a):a===c||b(c)&&a instanceof c||a.constructor===c}function p(a,b){for(var d=0,e=b.length;e>d;d++)if(!b[d](a))throw new TypeError("an assertion of the model is not respected: "+c(b[d]))}function q(a,b,c,d){if(c instanceof h.Function)return c(b);if(j(c))return n(b,c,d),b;var e=b instanceof Object?b:Object.create(null),f=Object.create(Object.getPrototypeOf(e));return Object.keys(c).forEach(function(g){var h=d?[d,g].join("."):g,i=g.toUpperCase()!=g;Object.defineProperty(f,g,{get:function(){return q(a,e[g],c[g],h)},set:function(d){if(!i&&void 0!==e[g])throw new TypeError("cannot redefine constant "+g);var f=q(a,d,c[g],h);m(f,c[g],h);var j=e[g];e[g]=f;try{p(b,a.assertions)}catch(k){throw e[g]=j,k}},enumerable:"_"!==g[0]})}),f}function r(a,b,c,d){c.forEach(function(c){Object.defineProperty(a,c,{get:function(){return b[c]},set:function(a){n(a,d.definition,"Array["+c+"]");var e=b.slice();e[c]=a,p(e,d.assertions),b[c]=a}})})}var s=Array.isArray||function(a){return a instanceof Array};Number.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},Object.setPrototypeOf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]}),h.prototype=Object.create(Function.prototype),h.prototype.toString=function(a){return c(this.definition,a)},h.prototype.validate=function(a){m(a,this.definition),p(a,this.assertions)},h.prototype.isValidModelFor=function(a){try{return this.validate(a),!0}catch(b){return!1}},h.prototype.extend=function(){var a=new this.constructor(k(this.definition,arguments));return a.prototype=Object.create(this.prototype),a.prototype.constructor=a,a.assertions=e(this.assertions),a},h.prototype.assert=function(){return this.assertions=this.assertions.concat(e(arguments).filter(b)),this},h.Object=function u(a){var b=function(a){if(!(this instanceof b))return new b(a);g(this,a,!0);var c=q(b,this,b.definition);return b.validate(c),c};return i(b,u,Object.create(Object.prototype),a)},h.Object.prototype=Object.create(h.prototype),h.Object.prototype.defaults=function(a){return g(this.prototype,a),this};var t=["pop","push","reverse","shift","sort","splice","unshift"];h.Array=function v(a){var b=function(){var a=e(arguments);if(!(this instanceof b))return new(Function.prototype.bind.apply(b,[null].concat(a)));b.validate(a);var c=this;return t.forEach(function(d){Object.defineProperty(c,d,{configurable:!0,value:function(){var e=a.slice();Array.prototype[d].apply(e,arguments),b.validate(e);var f=Object.keys(e).filter(function(a){return!(a in c)});return r(c,a,f,b),Array.prototype[d].apply(a,arguments)}})}),r(c,a,Object.keys(a),b),Object.defineProperty(c,"length",{enumerable:!1,get:function(){return a.length}}),c};return i(b,v,Object.create(Array.prototype),a)},h.Array.prototype=Object.create(h.prototype),h.Array.prototype.validate=function(a){if(!s(a))throw new TypeError("expecting an array, got: "+c(a));for(var b=0,d=a.length;d>b;b++)n(a[b],this.definition,"Array["+b+"]");p(a,this.assertions)},h.Array.prototype.toString=function(a){return"Model.Array("+c(this.definition,a)+")"},h.Function=function w(){var a=function(b){if(!(this instanceof a))return new a(b);var d=a.definition,f=function(){var f=g(e(arguments),d.defaults);if(f.length!==d.arguments.length)throw new TypeError("expecting "+c(b)+" to be called with "+d.arguments.length+" arguments, got "+f.length);d.arguments.forEach(function(a,b){n(f[b],a,"arguments["+b+"]")}),p(f,a.assertions);var h=b.apply(this,f);return"return"in d&&n(h,d["return"],"return value"),h};return Object.setPrototypeOf(f,a.prototype),f.constructor=w,f};return i(a,w,Object.create(Function.prototype),{arguments:e(arguments)})},h.Function.prototype=Object.create(h.prototype),h.Function.prototype.validate=function(a){if(!b(a))throw new TypeError("expecting a function, got: "+c(a))},h.Function.prototype.toString=function(a){var b="Model.Function("+this.definition.arguments.map(function(b){return c(b,a)}).join(",")+")";return"return"in this.definition&&(b+=".return("+c(this.definition["return"])+")"),b},h.Function.prototype["return"]=function(a){return this.definition["return"]=a,this},h.Function.prototype.defaults=function(){return this.definition.defaults=e(arguments),this},a.Model=h}(this);