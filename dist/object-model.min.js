;(function(a){function C(a,b){return b instanceof a}function D(a){return"function"==typeof a}function E(a){return"object"==typeof a}function F(a){return a&&E(a)&&Object.getPrototypeOf(a)===Object.prototype}function G(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1]}function H(a,b){Object.keys(b||{}).forEach(c=>{if(F(b[c])){const d={};H(d,a[c]),H(d,b[c]),a[c]=d}else a[c]=b[c]})}function o(a,b,c,d){B(a,b,{value:c,enumerable:d,writable:!0,configurable:!0})}function I(a,b){Object.setPrototypeOf(a,b[u]),o(a,v,b)}function J(a,b){a[u]=Object.create(b),a[u][v]=a}function K(a,b=[]){if(15<b.length||b.includes(a))return"...";if(null==a)return a+"";if("string"==typeof a)return`"${a}"`;if(C(L,a))return a.toString(b);if(b=[a].concat(b),D(a))return a.name||a.toString(b);if(C(Array,a))return`[${a.map(a=>K(a,b)).join(", ")}]`;if(a.toString!==Object.prototype.toString)return a.toString();if(a&&E(a)){const c=Object.keys(a),d="\t".repeat(b.length);return`{${c.map(c=>`\n${d+c}: ${K(a[c],b)}`).join(",")} ${c.length?`\n${d.slice(1)}`:""}}`}return a+""}function L(a){if(!M(a))return L[b](a);const c=function(a=c[w]){return c[j](a),a};return N(c,a,L),c}function N(a,b,c){I(a,c),a[g]=b,a[h]=a[h].slice(),o(a,r,[])}function O(a){if(M(a)){if(!C(Array,a))return[a];if(1===a.length)return[...a,void 0,null]}else for(let b of a)a[b]=O(a[b]);return a}function P(a,b,c,d,e){if(C(L,b)){const f=e.indexOf(b);return-1!==f&&-1!==e.indexOf(b,f+1)?void 0:b[k](a,c,d,e.concat(b))}if(M(b)){const g=O(b);if(g.some(b=>R(a,b,c,e)))return;d.push({[m]:b,[n]:a,[p]:c})}else Object.keys(b).forEach(g=>{const f=null==a?void 0:a[g];P(f,b[g],c?c+"."+g:g,d,e)})}function R(a,b,c,d){if(null==a)return a===b;if(!M(b)||C(L,b)){const e=[];return P(a,b,c,e,d),!e.length}return C(RegExp,b)?b[l](a):b===Number||b===Date?a[v]===b&&!isNaN(a):a===b||D(b)&&C(b,a)||a[v]===b}function Q(a,b,c=b[r]){for(let d of b[h]){let e;try{e=d.call(b,a)}catch(f){e=f}!0!==e&&c.push({[q]:d[i].call(b,e,a)})}}function S(a,b,c,d){if(C(L,c)&&b&&!C(c,b))return c(b);if(C(Array,c)){let g=[];for(let h of c.filter(a=>C(L,a))){if(C(h,b))return b;h.test(b)&&g.push(h)}return 1===g.length?g[0](b):(1<g.length&&console.warn(`Ambiguous model for value ${K(b)},
			 could be ${g.join(" or ")}`),b)}return M(c)?b:new Proxy(b||{},{get(f,e){const b=d?d+"."+e:e;return S(a,f[e],c[e],b)},set(j,g,l){const f=d?d+"."+g:g,h=L[e](g),i=j[g];if(h&&void 0!==i&&a[r].push({[q]:`cannot redefine constant ${g}`}),c.hasOwnProperty(g)){const k=S(a,l,c[g],f);P(k,c[g],f,a[r],[]),j[g]=k,Q(b,a)}else a[r].push({[q]:`cannot find property ${f} in the model definition`});a[r].length&&(j[g]=i,a[t]())},has(a,b){return Reflect.has(a,b)&&!L[f](b)},ownKeys(a){return Reflect.ownKeys(a).filter(a=>!L[f](a))},getPrototypeOf(){return a[u]}})}function T(a,b,c){return function(){const d=a.slice();return Array[u][b].apply(d,arguments),c[j](d),Array[u][b].apply(a,arguments)}}function U(a,b,d,e){parseInt(b)===+b&&0<=b&&P(d,e[g],c+"["+b+"]",e[r],[]);const f=a.slice();f[b]=d,Q(f,e),e[t](),a[b]=d}const b="Object",c="Array",d="Function",e="conventionForConstant",f="conventionForPrivate",g="definition",h="assertions",i="_onFail",j="validate",k="_validator",l="test",m="expected",n="received",p="path",q="message",r="errorStack",s="errorCollector",t="unstackErrors",u="prototype",v="constructor",w="default",x="defaults",y="return",z="arguments",A=["pop","push","reverse","shift","sort","splice","unshift"],B=Object.defineProperty;J(L,Function[u]),Object.assign(L[u],{toString(b){return O(this[g]).map(a=>K(a,b)).join(" or ")},[h]:[],[j](a,b){this[k](a,null,this[r],[]),this[t](b)},[l](b){const a=[];return this[k](b,null,a,[]),!a.length},["extend"](){let a,c,d=[...this[h]];const e=[...arguments];C(L[b],this)?(a={},c={},Object.assign(a,this[g]),Object.assign(c,this[u]),e.forEach(b=>{C(L,b)?(H(a,b[g]),H(c,b[u])):H(a,b)})):a=e.reduce((a,b)=>a.concat(O(b)),O(this[g])).filter((b,c,a)=>a.indexOf(b)===c),e.forEach(a=>{C(L,a)&&(d=d.concat(a[h]))});const f=new this[v](a);return J(f,this[u]),Object.assign(f[u],c),f[h]=d,f[s]=this[s],f},assert(b,a=K(b)){const c=D(a)?a:(b,c)=>`assertion "${a}" returned ${K(b)} for value ${K(c)}`;return o(b,i,c),this[h]=this[h].concat(b),this},defaultTo(a){return this[w]=a,this},[s](a){throw new TypeError(a.map(function(a){return a[q]}).join("\n"))},[k](a,b,c,d){P(a,this[g],b,c,d),Q(a,this,c)},[t](a){if(this[r].length){a||(a=this.errorCollector);const b=this[r].map(a=>{if(!a[q]){const b=C(Array,a[m])?a[m]:[a[m]];a[q]="expecting "+(a[p]?a[p]+" to be ":"")+b.map(a=>K(a)).join(" or ")+", got "+(null==a[n]?"":G(a[n])+" ")+K(a[n])}return a});this[r]=[],a.call(this,b)}}}),L[e]=a=>a.toUpperCase()===a,L[f]=a=>"_"===a[0];const M=a=>"Object"!=G(a);L[b]=function(a){const c=function(a=c[w]){if(!C(c,this))return new c(a);H(this,a);const b=S(c,this,c[g]);return c[j](b),b};return J(c,Object[u]),N(c,a,L[b]),c},J(L[b],L[u]),Object.assign(L[b][u],{[x](a){return Object.assign(this[u],a),this},toString(a){return K(this[g],a)},[k](a,c,b,d){E(a)?P(a,this[g],c,b,d):b.push({[m]:this,[n]:a,[p]:c}),Q(a,this)}}),L[c]=function(a){const b=function(a=b[w]){return b[j](a),new Proxy(a,{get(c,a){return a===v?b:A.includes(a)?T(c,a,b):c[a]},set(a,c,d){U(a,c,d,b)},getPrototypeOf(){return b[u]}})};return J(b,Array[u]),N(b,a,L[c]),b},J(L[c],L[u]),Object.assign(L[c][u],{toString(a){return c+" of "+K(this[g],a)},[k](a,b,e,f){C(Array,a)?a.forEach((a,d)=>P(a,this[g],`${b||c}[${d}]`,e,f)):e.push({[m]:this,[n]:a,[p]:b}),Q(a,this)}}),L[d]=function(){const a=function(b=a[w]){const c=a[g],d=function(){const d=[];Object.assign(d,c[x]),Object.assign(d,[...arguments]),d.length>c[z].length&&a[r].push({[m]:K(b)+" to be called with "+c[z].length+" "+z,[n]:d.length}),c[z].forEach((c,b)=>P(d[b],c,`${z}[${b}]`,a[r],[])),Q(d,a);let e;return a[r].length||(e=b.apply(this,d),y in c&&P(e,c[y],y+" value",a[r],[])),a[t](),e};return I(d,a),d};J(a,Function[u]);const b={[z]:[...arguments]};return N(a,b,L[d]),a},J(L[d],L[u]),Object.assign(L[d][u],{toString(b){let a=d+"("+this[g][z].map(a=>K(a,b)).join(",")+")";return y in this[g]&&(a+=" => "+K(this[g][y])),a},[y](a){return this[g][y]=a,this},[x](){return this[g][x]=[...arguments],this},[k](a,c,b){D(a)||b.push({[m]:d,[n]:a,[p]:c})}}),a.Model=L})(this);
//# sourceMappingURL=object-model.min.js.map
